---
summary: "OpenClaw 위협 모델 개요 (MITRE ATLAS 기반)"
read_when:
  - 보안 위협 분석을 이해하고 싶을 때
  - 공격 체인과 위협을 검토할 때
title: "위협 모델"
---

# 위협 모델

## MITRE ATLAS 프레임워크

OpenClaw 위협 모델은 AI/ML 시스템에 대한 적대적 위협을 문서화하기 위해 설계된 [MITRE ATLAS](https://atlas.mitre.org/) 프레임워크를 기반으로 합니다.

## 범위

| 구성 요소 | 포함 | 비고 |
|-----------|------|------|
| OpenClaw 에이전트 런타임 | 예 | 핵심 에이전트 실행, 도구 호출, 세션 |
| Gateway | 예 | 인증, 라우팅, 채널 통합 |
| 채널 통합 | 예 | WhatsApp, Telegram, Discord, Signal, Slack 등 |
| ClawHub 마켓플레이스 | 예 | 스킬 게시, 모더레이션, 배포 |
| MCP 서버 | 예 | 외부 도구 프로바이더 |
| 사용자 디바이스 | 부분적 | 모바일 앱, 데스크톱 클라이언트 |

## 신뢰 경계

```
┌──────────────────────────────────────────────┐
│              비신뢰 영역                       │
│  WhatsApp  │  Telegram  │  Discord  │  ...    │
└──────┬─────┴──────┬─────┴──────┬────┘
       │            │            │
       ▼            ▼            ▼
┌──────────────────────────────────────────────┐
│        신뢰 경계 1: 채널 접근                  │
│  • 디바이스 페어링                             │
│  • AllowFrom / AllowList 검증                 │
│  • 토큰/비밀번호/Tailscale 인증               │
└──────────────────────────────────────────────┘
       │
       ▼
┌──────────────────────────────────────────────┐
│        신뢰 경계 2: 세션 격리                  │
│  • 세션 키 = agent:channel:peer              │
│  • 에이전트별 도구 정책                       │
│  • 트랜스크립트 로깅                          │
└──────────────────────────────────────────────┘
       │
       ▼
┌──────────────────────────────────────────────┐
│        신뢰 경계 3: 도구 실행                  │
│  • Docker 샌드박스 또는 호스트 (실행 승인)    │
│  • 노드 원격 실행                             │
│  • SSRF 보호 (DNS 고정 + IP 차단)            │
└──────────────────────────────────────────────┘
```

## 주요 위협 카테고리

### 실행 위협

| ID | 위협 | 심각도 |
|----|------|--------|
| T-EXEC-001 | 직접 프롬프트 인젝션 | Critical |
| T-EXEC-002 | 간접 프롬프트 인젝션 (가져온 콘텐츠 경유) | High |
| T-EXEC-004 | 실행 승인 우회 | High |

### 지속성 위협

| ID | 위협 | 심각도 |
|----|------|--------|
| T-PERSIST-001 | 악성 스킬 게시 | Critical |
| T-PERSIST-002 | 업데이트 체인 손상 | High |

### 데이터 유출 위협

| ID | 위협 | 심각도 |
|----|------|--------|
| T-EXFIL-001 | 에이전트를 통한 민감 데이터 유출 | High |
| T-EXFIL-003 | 자격 증명 수확 | Critical |

### 접근 위협

| ID | 위협 | 심각도 |
|----|------|--------|
| T-ACCESS-003 | 토큰 저장소 접근 | High |

## 주요 공격 체인

**공격 체인 1: 스킬 기반 데이터 도난**
```
T-PERSIST-001 → T-EVADE-001 → T-EXFIL-003
(악성 스킬 게시) → (모더레이션 회피) → (자격 증명 수확)
```

**공격 체인 2: 프롬프트 인젝션에서 RCE로**
```
T-EXEC-001 → T-EXEC-004 → T-IMPACT-001
(프롬프트 주입) → (실행 승인 우회) → (명령 실행)
```

**공격 체인 3: 가져온 콘텐츠를 통한 간접 인젝션**
```
T-EXEC-002 → T-EXFIL-001 → 외부 유출
(URL 콘텐츠 오염) → (에이전트가 지시를 따름) → (공격자에게 데이터 전송)
```

## 현재 완화 조치

### 모더레이션 플래그 패턴

`moderation.ts`에서 알려진 악성 식별자와 의심스러운 키워드를 정규식으로 검사합니다:

- 알려진 악성 식별자
- 악성코드/피싱 관련 키워드
- API 키/토큰/비밀번호 관련 패턴
- 지갑/시드 구문 관련 패턴
- 단축 URL 패턴

**제한사항:** slug, displayName, summary, frontmatter, 메타데이터, 파일 경로만 검사하며, 실제 스킬 코드 내용은 분석하지 않습니다.

## 권장 사항

### 즉시 (P0)

| ID | 권장 사항 |
|----|----------|
| R-001 | VirusTotal 통합 완료 |
| R-002 | 스킬 샌드박싱 구현 |
| R-003 | 민감한 작업에 대한 출력 검증 추가 |

### 단기 (P1)

| ID | 권장 사항 |
|----|----------|
| R-004 | 속도 제한 구현 |
| R-005 | 저장 시 토큰 암호화 추가 |
| R-006 | 실행 승인 UX 및 검증 개선 |
| R-007 | web_fetch에 대한 URL 허용 목록 구현 |

### 중기 (P2)

| ID | 권장 사항 |
|----|----------|
| R-008 | 가능한 경우 암호화 채널 검증 추가 |
| R-009 | 설정 무결성 검증 구현 |
| R-010 | 업데이트 서명 및 버전 고정 추가 |

## 기여

이것은 OpenClaw 커뮤니티가 유지하는 살아있는 문서입니다. 전체 위협 모델은 영문 문서 [THREAT-MODEL-ATLAS.md](https://github.com/openclaw/openclaw/blob/main/docs/security/THREAT-MODEL-ATLAS.md)를 참조하세요.
